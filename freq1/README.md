# 频率特性实验 (Frequency Analysis Experiment)

## 实验目标

本实验旨在研究机器学习模型对频率特征的学习能力。通过生成具有明显频率特征的数据样本，并使用神经网络进行拟合，观察模型对不同频率成分的学习效果。

## 实验设计

### 第一部分：数据生成与神经网络拟合

1. **数据生成**：根据给定参数 `{a0, a1, b1, a2, b2, ...}` 构造函数：
   ```
   f(x) = a0 + a1*sin(x+b1) + a2*sin(2x+b2) + a3*sin(3x+b3) + ...
   ```

2. **数据采样**：从函数中采样 `{(xi, yi)}` 作为训练样本

3. **模型训练**：设计两层神经网络学习拟合该函数

4. **结果分析**：比较原函数与拟合结果，分析频率学习效果

## 目录结构

```
freq1/
├── README.md              # 实验说明
├── config.py              # 实验配置
├── data_generator.py      # 数据生成器
├── model.py               # 神经网络模型
├── train.py               # 训练脚本
├── visualize.py           # 可视化工具
├── experiment.py          # 主实验脚本
├── data/                  # 数据目录
│   ├── raw/              # 原始数据
│   └── processed/        # 处理后数据
├── models/               # 保存的模型
├── results/              # 实验结果
│   ├── plots/           # 图表
│   └── logs/            # 日志
└── notebooks/            # 分析笔记本
```

## 快速开始

### 第一步实验：函数拟合
```bash
# 快速演示（使用scikit-learn）
python simple_demo.py

# 完整演示（使用PyTorch）
python demo.py

# 完整训练
python train.py
```

### 第二步实验：频域参数拟合
```bash
# 快速演示频域参数拟合
python freq2_demo.py

# 完整参数拟合实验
python train_parameter_model.py
```

## 实验特性

### 第一步：函数拟合
- **数据生成**: 支持多频率成分的复合函数
- **神经网络**: 两层全连接网络，拟合 (x,y) 映射关系
- **训练优化**: Adam优化器，学习率调度，早停机制
- **可视化**: 训练过程监控，拟合结果对比

### 第二步：频域参数拟合
- **参数预测**: 直接从数据点预测 {a0, a1, b1, a2, b2, ...} 参数
- **复合损失函数**: 
  - 参数损失 (MSE)
  - 重构损失 (函数重建误差)
  - 一致性损失 (预测vs真实参数重构对比)
  - 正则化损失 (L1/L2约束)
  - 边界约束损失 (参数范围限制)
- **高级网络架构**: 多层感知机，支持Dropout和批归一化
- **智能训练**: 早停，学习率衰减，梯度裁剪
- **全面评估**: 参数精度，函数重构质量，可视化对比

## 参数说明

- `a0`: 常数项
- `a1, a2, a3, ...`: 各频率成分的幅度
- `b1, b2, b3, ...`: 各频率成分的相位
- `num_samples`: 采样点数量
- `x_range`: 采样范围
- `noise_level`: 噪声水平